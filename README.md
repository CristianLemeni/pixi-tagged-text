# pixi-rich-text

[![NPM](https://nodei.co/npm/pixi-rich-text.png)](https://nodei.co/npm/pixi-rich-text/)

Add a `RichText` object inside [pixi.js](https://github.com/GoodBoyDigital/pixi.js) to easily create text using different styles.

Inspired by the original [pixi-multistyle-text](https://github.com/tleunen/pixi-multistyle-text)

## Architecture

RichText allows you to control text with multiple styles and embedded images as though it were a single Pixi component. It was inspired by [pixi-multistyle-text](https://github.com/tleunen/pixi-multistyle-text) but is structurally rather different. Pixi-rich-text creates a separate PIXI.Text object for each separately positioned element (word) in its text. This allows developers to have control over individual words or even characters for the purposes of animation or other effects. It also makes embedding sprites into the layout easier. In contrast, pixi-multistyle-text creates a single bitmap drawing based on the contents of text. Cosmetically, they're very similar, however, the overhead of creating multiple Text objects is much larger making RichText a potentially very heavy component. **If you require maximum performance, consider using [pixi-multistyle-text](https://github.com/tleunen/pixi-multistyle-text)**.

### Life-cycle

In order to maximize performance of RichText, it helps to understand how it renders the input.

1. Constructor - creating the component is the first step. You can set text, styles, and options in the constructor.
2. `update()` - Update generates a list of plain JS object tokens that hold information on what type of text to create and where to position it. The tokens contain all the information you need to draw the text and are saved as `myText.tokens` but also returned by `myText.update()`. By default, this is called every time the text or style definitions are changed (e.g. `setTagStyles()`, `setText()`). This is a fairly expensive process but faster than `draw()`.
3. `draw()` - Draw creates the child objects based on the data generated by `update()`. It clears any existing children (if needed) then recreates and positions them. This is probably the costliest function in the life-cycle. By default, this is called automatically in `update()`.

Of course, you won't see anything on your screen until your component is added to a visible PIXI container.

#### `skipUpdates` & `skipDraw`

If performance is becoming an issue, you can use the `skipUpdates` and `skipDraw` flags in the options object with `new RichText()` to disable automatic updates and automatic drawing (more on that below). This gives you control over when the update() or draw() function will be called. However, the component can become out of sync with what you see on your screen so use this with caution.

```typescript
const noDraw = new RichText("", {}, {skipDraw: true});
const words = ["lorem", "ipsum",... ];
for (let i = 0; i < words.length; i++){
  noDraw.text += words[i];
  // noDraw.tokens will be updated to match the new text.
}
noDraw.textContainer.length; // 0 - text fields never got created.
noDraw.draw();
noDraw.textContainer.length; // This will now contain all the PIXI.Text objects created by draw.
```

## Options

The third parameter in the RichText constructor is a set of options.

```typscript
{
  debug?: boolean; // If true, generates debug information which is overlaid on the text and logged to the console during draw(). default is false.
  splitStyle?: SplitStyle; // Not implemented yet. Allows you to specify how the text should be split into PIXI.Text objects. Optional values are "words" (default) and "characters".
  imgMap?: ImageMap; // An object that maps string names like "myImage" to Sprite objects like `PIXI.Sprite.from("./myImage.png")`. When a style contains imgSrc="myImage", the matching sprite is used. By default, each of the keys you provide here will automatically be added as a style in the tagStyles (equivalent to `{ myImage: { imgSrc: "myImage"}}`) so you can add a tag `<myImage />`. default is {}.
  skipUpdates?: boolean; // When true, update() will not be called when text or styles are changed; it must be called explicitly or overridden using the skipUpdate parameter in functions such as setText(). default is false.
  skipDraw?: boolean; // When true, draw() will not be called by update(); it must be called explicitly or overridden using the skipDraw parameter, e.g. `myRichText.update(false)`. default is false.
}
```

## Example

TBD

## Build instructions

```bash
$ yarn install
$ yarn build
```

## Usage

TBD

## Demo

You can view some examples using the command:

```bash
$ yarn demo
```

This will start a simple HTTP server running locally on port 8080.

## License

MIT, see [LICENSE.md](http://github.com/tleunen/pixi-multistyle-text/blob/master/LICENSE.md) for details.
